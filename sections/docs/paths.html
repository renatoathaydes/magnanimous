<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="icon" type="image/png" sizes="32x32" href="/magnanimous/images/ico/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/magnanimous/images/ico/favicon-16x16.png">
    <title>Paths and Links</title>
    <link rel="stylesheet" href="/magnanimous/css/styles.css">
    <link rel="stylesheet" href="/magnanimous/css/docs.css">
</head>
<div class="docs-top">
    <img src="/magnanimous/images/magnanimous-car-mini.jpg" width="60em" alt="Magnanimous Gopher">
    <span class="docs-link">
        <a href="/magnanimous/sections/docs.html">Magnanimous Documentation</a>
    </span>
</div>
<div class="main-body">
<h1>3. Paths and Links</h1>

<p>When writing your website, you&rsquo;ll probably want to make use of several <a href="/magnanimous/sections/docs/expression_lang.html">Magnanimous instructions</a>
which need to point to another source file. They do that by telling Magnanimous the <strong>path</strong> to the other file.</p>

<p>You&rsquo;ll also likely add <strong>links</strong> to other files in your pages, so that users can easily navigate between the pages
of your website.</p>

<p>The two concepts are somewhat similar, but definitely not the same.</p>

<p>A <strong>path</strong> is a compilation-time concept and doesn&rsquo;t exist at runtime, while <strong>links</strong> only exist at runtime.</p>

<p>In the next sections, you&rsquo;ll learn what that means in detail, so you never have to spend time wondering why a link
does not point where you thought it ought to, or a path does not resolve correctly, giving you compile time warnings.</p>

<h2>Paths</h2>

<p><a href="components.html">Components</a>, the <a href="expression_lang.html#for">for</a> and the <a href="expression_lang.html#include">include</a>
instructions all need to declare a reference to some file, or directory in the case of <a href="expression_lang.html#for">for</a>.</p>

<p>They need to know where to find the information necessary to do their job: the contents of a file, in the case of
the <code>include</code> and <code>component</code> instructions, and the directory containing the files to be iterated over, in the case of
the <code>for</code> instruction.</p>

<p>Paths can be of three types:</p>

<ul>
<li>Absolute paths</li>
<li>Relative paths</li>
<li>Up paths</li>
</ul>

<h3>Absolute paths</h3>

<p><strong>Absolute paths</strong> start with a <code>/</code>, and are always interpreted as being under the
<a href="get_started.html#magnanimous-directories"><code>source/</code></a> directory.</p>

<p>Example:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>{{ include /processed/_header.html }}
</span></span></code></pre>
<h3>Relative paths</h3>

<p><strong>Relative paths</strong>, unlike absolute paths, do not start with a <code>/</code> and are resolved by the location of the file they
are declared in.</p>

<p>Example:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>{{ include _header.html }}
</span></span></code></pre>
<p>If the above inclusion is done from the file <code>/processed/components/_comp1.html</code>, then the path, <code>_header.html</code>, will point to the file at <code>/processed/components/_header.html</code>.</p>

<p>If the inclusion is from <code>/processed/_comp2.html</code>, then it points to <code>/processed/_header.html</code>.</p>

<p>Relative paths can also refer to a parent directory if they start with <code>../</code>, just like in most file systems.</p>

<p>However, trying to access anything above the <code>source/</code> directory is forbidden and will result in the <code>../</code> part
being ignored.</p>

<h3>Up paths</h3>

<p><strong>Up paths</strong> refer to a file located at the same location of the <strong>file currently being written</strong> by Magnanimous (not necessarily the location of the file the <code>include</code> statement is declared in, as with absolute and relative paths),
or any parent directory <strong>up to</strong> the <code>source</code> directory.</p>

<p>Example:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>{{ include .../_messages }}
</span></span></code></pre>
<p><em>Up paths</em> are special in that the file they point to depends on the context. They are commonly used to allow overriding which file should be used, which is useful for things like internationalization.</p>

<p>For example, given this file structure:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>source
</span></span><span style="display:flex;"><span>└── processed
</span></span><span style="display:flex;"><span>    ├── _header.html
</span></span><span style="display:flex;"><span>    ├── index.html
</span></span><span style="display:flex;"><span>    ├── _messages
</span></span><span style="display:flex;"><span>    └── pt
</span></span><span style="display:flex;"><span>    |   ├── _messages
</span></span><span style="display:flex;"><span>    |   └── index.html
</span></span><span style="display:flex;"><span>    └── sv
</span></span><span style="display:flex;"><span>        └── index.html
</span></span></code></pre>
<p>Assuming <code>source/processed/_header.html</code> has the following contents:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>{{ include .../_messages }}
</span></span><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#2838b0">html</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#2838b0">head</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#2838b0">title</span><span style="color:#888"></span><span style="color:#888">&gt;</span>{{ eval title }}<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">title</span><span style="color:#888">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">head</span><span style="color:#888">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#2838b0">body</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
</span></span></code></pre>
<blockquote>
<p>Notice that the header file uses an <em>up path</em>, <code>.../_messages</code>.</p>
</blockquote>

<p>If the <code>source/processed/index.html</code> file <code>include</code>s this header, it will get messages from <code>source/processed/_messages</code> because that&rsquo;s the nearest <code>_messages</code> file looking up the directory tree.</p>

<p>If the <code>source/processed/pt/index.html</code> file <code>include</code>s the header, its messages will come from <code>source/processed/pt/_messages</code> instead!</p>

<p>If the <code>source/processed/sv/index.html</code> file <code>include</code>s the header, because there&rsquo;s no <code>_messages</code> file on the same directory, Magnanimous will look up the directory tree, and find the <code>source/processed/_messages</code> file, so it will
include that.</p>

<p>Simple, but effective.</p>

<h3>Expression paths</h3>

<p>Paths can also be given by <a href="expression_lang.html#expressions">expressions</a> if starting with <code>&quot;</code> or <code>`</code>,
or explicitly with <code>eval &lt;expr&gt;</code>.</p>

<p>For example, the paths in these <a href="expression_lang.html#include">include</a> instructions all evaluate to
<code>/hello/world/file.html</code>:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>{{ include /hello/world/file.html }}
</span></span><span style="display:flex;"><span>{{ include &#34;/hello&#34; + &#34;/world&#34; + &#34;/file.html&#34; }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{ define dir &#34;/hello/world/&#34; }}
</span></span><span style="display:flex;"><span>{{ include eval dir + &#34;file.html }}
</span></span></code></pre>
<h3>Path variables</h3>

<p>Even though most of the time, paths are declared as simple expressions or unquoted strings, it is possible to
explicitly declare a path as follows:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#888">{</span><span style="color:#888">{</span> define my_path path<span style="color:#888">[</span><span style="color:#b83838">&#34;/processed/example/file.txt&#34;</span><span style="color:#888">]</span> <span style="color:#888">}</span><span style="color:#888">}</span>
</span></span></code></pre>
<p>This is useful to read the top-level variables defined by another file.
For example, suppose the file at <code>/processed/example/file.txt</code> contained the following definition:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#888">{</span><span style="color:#888">{</span> define astronaut <span style="color:#b83838">&#34;Neil Armstrong&#34;</span> <span style="color:#888">}</span><span style="color:#888">}</span>
</span></span></code></pre>
<p>Then, given <code>my_path</code> defined above, we can evaluate this definition in another file:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>The first astronaut to step on the Moon was <span style="color:#888">{</span><span style="color:#888">{</span> <span style="color:#388038">eval</span> my_path<span style="color:#888">.</span>astronaut <span style="color:#888">}</span><span style="color:#888">}</span><span style="color:#888">.</span>
</span></span></code></pre>
<p>It is even possible to refer to the current file:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>This file is at <span style="color:#888">{</span><span style="color:#888">{</span> <span style="color:#388038">eval</span> path<span style="color:#888">[</span><span style="color:#b83838">&#34;.&#34;</span><span style="color:#888">]</span> <span style="color:#888">}</span><span style="color:#888">}</span><span style="color:#888">.</span>
</span></span></code></pre>
<p>Path variables can also be used with <a href="expression_lang.html#expressions">date expressions</a>:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#888">{</span><span style="color:#888">{</span> define <span style="color:#2838b0">this</span> path<span style="color:#888">[</span><span style="color:#b83838">&#34;.&#34;</span><span style="color:#888">]</span> <span style="color:#888">}</span><span style="color:#888">}</span>
</span></span><span style="display:flex;"><span>This file <span style="color:#b83838">`</span><span style="color:#b83838">{{eval this}}</span><span style="color:#b83838">`</span> was last updated on <span style="color:#888">{</span><span style="color:#888">{</span> <span style="color:#388038">eval</span> date<span style="color:#888">[</span><span style="color:#2838b0">this</span><span style="color:#888">]</span> <span style="color:#888">}</span><span style="color:#888">}</span><span style="color:#888">.</span>
</span></span></code></pre>
<p>Here&rsquo;s how the above code sample renders on this document itself!</p>

<blockquote>
<p>This file <code>website/source/processed/sections/docs/paths.md</code> was last updated on 02 Jul 2022, 11:20 AM.</p>
</blockquote>

<h3>When are paths resolved?</h3>

<p>Paths are resolved when Magnanimous is writing the generated website files.</p>

<p>Notice that paths are a compile-time concept, which means that they are only used by Magnanimous instructions, during
compilation, to resolve the contents of the files that will be part of the website. For this reason, paths can
point to <em>no-writable</em> files (whose file names start with <code>_</code>, which are not copied to the final website).</p>

<p>Once the website is created, instructions and paths simply do not exist anymore! All you have is a bunch of static
files ready to be served by a <em>dumb</em> web server.</p>

<p>For this reason, paths should always point to other source files, not to generated files.</p>

<p>Links, on the other hand, are a different story, as we&rsquo;ll see.</p>

<h2>Links</h2>

<p>Links are not really a Magnanimous concept, but a <em>Markdown</em> and <em>HTML</em> concept. But because, like paths, they point
to another file (or website), they can be confused with paths, so some explanation of what&rsquo;s different between them
is warranted.</p>

<p>Example:</p>

<h4>Markdown</h4>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>My favourite site is [<span style="color:#2838b0">Wikipedia</span>](<span style="color:#388038">https://www.wikipedia.org/</span>).
</span></span></code></pre>
<h4>HTML</h4>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#2838b0">p</span><span style="color:#888"></span><span style="color:#888">&gt;</span>My favourite site is <span style="color:#888">&lt;</span><span style="color:#2838b0">a</span> <span style="color:#388038">href</span><span style="color:#666">=</span><span style="color:#b83838">&#34;https://www.wikipedia.org/&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Wikipedia<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">a</span><span style="color:#888">&gt;</span>.<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">p</span><span style="color:#888">&gt;</span>
</span></span></code></pre>
<p>The big difference between links and paths is simple: links are only ever used at runtime,
while paths are used by Magnanimous at compile time to resolve <a href="/magnanimous/sections/docs/expression_lang.html">Magnanimous instructions</a>.</p>

<p>This has an important implication: while paths point to source files, links point to generated files (or other websites).</p>

<p>So, if you want to add a link to some content you wrote in a markdown file, say <code>/processed/blog/post.md</code>, the link to it
should point to <code>/processed/blog/post.html</code>, the generated file, not the source file.</p>

<blockquote>
<p>Notice that all processed <code>.md</code> files are converted to <code>.html</code> files by Magnanimous.
  See the <a href="markdown_guide.html">Markdown Guide</a> for details.</p>
</blockquote>

<h3>When are links resolved?</h3>

<p>Links are resolved by the browser when users click on links on your HTML pages.</p>

<p>They are part of the language you&rsquo;re using to write content, be it HTML or Markdown, and are not used by Magnanimous.</p>

<h3>Consider the base path in your links</h3>

<p>If your website is not served from the root path within your domain, you might also need to consider the base path!</p>

<p>For example, if your website will be served under the <code>https://user1.github.io/my-project</code> URL (as a project called
<code>my-project</code> by <code>user1</code>, served via <a href="https://pages.github.com/">GitHub pages</a> would), then your links need to take the
<code>/my-project</code> path (the base path) into account, so an absolute link to the source file <code>/processed/blog/post.md</code>
should actually point to <code>/my-project/blog/post.html</code>.</p>

<p>A good way to approach this is to define a <code>basePath</code> variable in the <code>/processed/_global_context</code> file, as in this
example:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>{{ define basePath &#34;/my-project/&#34; }}
</span></span></code></pre><div class="file-box">source/processed/_global_context</div><p>Now, from any other processed file, a link can be safely created as follows:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#888">&lt;</span><span style="color:#2838b0">a</span> <span style="color:#388038">href</span><span style="color:#666">=</span><span style="color:#b83838">&#34;{{ eval basePath + `blog/post.html` }}&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>A link<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">a</span><span style="color:#888">&gt;</span>
</span></span></code></pre>
<p>Or, in markdown:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>[<span style="color:#2838b0">A link</span>](<span style="color:#388038">{{ eval basePath + &#34;blog/post.html&#34; }}</span>)
</span></span></code></pre></div>
<div class="footer">
    <div>
        <small>
            Back to <a href="/magnanimous/sections/docs.html">Documentation Home</a>
        </small>
    </div>
</div>
</body>
</html>